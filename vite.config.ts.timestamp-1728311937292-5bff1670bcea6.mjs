// vite.config.ts
import { fileURLToPath, URL } from "node:url";
import { defineConfig } from "file:///root/p/pphome/nodejs/SongMingHe/node_modules/.pnpm/vite@5.4.8_@types+node@20.16.10/node_modules/vite/dist/node/index.js";
import vue from "file:///root/p/pphome/nodejs/SongMingHe/node_modules/.pnpm/@vitejs+plugin-vue@5.1.4_vite@5.4.8_@types+node@20.16.10__vue@3.5.10_typescript@5.4.5_/node_modules/@vitejs/plugin-vue/dist/index.mjs";
import vueJsx from "file:///root/p/pphome/nodejs/SongMingHe/node_modules/.pnpm/@vitejs+plugin-vue-jsx@4.0.1_vite@5.4.8_@types+node@20.16.10__vue@3.5.10_typescript@5.4.5_/node_modules/@vitejs/plugin-vue-jsx/dist/index.mjs";

// build.ts
import * as fs2 from "fs";
import grayMatter from "file:///root/p/pphome/nodejs/SongMingHe/node_modules/.pnpm/gray-matter@4.0.3/node_modules/gray-matter/index.js";

// buildUtils.ts
import MarkdownIt from "file:///root/p/pphome/nodejs/SongMingHe/node_modules/.pnpm/markdown-it@14.1.0/node_modules/markdown-it/index.mjs";
import * as fs from "fs";
var formateDate = (srcDate) => {
  let srcDateObj = srcDate;
  if (typeof srcDate === "string") {
    srcDateObj = new Date(Date.parse(srcDate));
  }
  return `${srcDateObj.getFullYear()}-${String(srcDateObj.getMonth() + 1).padStart(2, "0")}-${String(srcDateObj.getDate()).padStart(2, "0")}`;
};
var rmdir = (rmdirPath) => {
  try {
    fs.rmSync(rmdirPath, { recursive: true });
  } catch (err) {
    if (err && err.code !== "ENOENT") {
      throw err;
    }
  }
  fs.mkdirSync(rmdirPath);
};
var createMD = (imgPath) => {
  return MarkdownIt({
    html: true,
    // 在源码中启用 HTML 标签
    xhtmlOut: false,
    // 使用 '/' 来闭合单标签 （比如 <br />）。
    // 这个选项只对完全的 CommonMark 模式兼容。
    breaks: false,
    // 转换段落里的 '\n' 到 <br>。
    langPrefix: "language-",
    // 给围栏代码块的 CSS 语言前缀。对于额外的高亮代码非常有用。
    linkify: false,
    // 将类似 URL 的文本自动转换为链接。
    // 启用一些语言中立的替换 + 引号美化
    typographer: false,
    // 双 + 单引号替换对，当 typographer 启用时。
    // 或者智能引号等，可以是 String 或 Array。
    //
    // 比方说，你可以支持 '«»„“' 给俄罗斯人使用， '„“‚‘'  给德国人使用。
    // 还有 ['«\xA0', '\xA0»', '‹\xA0', '\xA0›'] 给法国人使用（包括 nbsp）。
    quotes: "\u201C\u201D\u2018\u2019",
    // 高亮函数，会返回转义的HTML。
    // 或 '' 如果源字符串未更改，则应在外部进行转义。
    // 如果结果以 <pre ... 开头，内部包装器则会跳过。
    highlight: function() {
      return "";
    }
  });
  md.use((md2) => {
    const rawImageRule = md2.renderer.rules.image;
    md2.renderer.rules.image = (tokens, idx, options, env, self) => {
      const token = tokens[idx];
      const link = token.attrGet("src");
      if (link) {
        token.attrSet("src", imgPath + link);
      }
      return rawImageRule(tokens, idx, options, env, self);
    };
    const createHtmlRule = (rawHtmlRule) => (tokens, idx, options, env, self) => {
      tokens[idx].content = tokens[idx].content.replace(
        /(<img\b.*?src=)(['"])(.*?)\2/gs,
        (_, prefix, quote, src) => `${prefix}${quote}${imgPath + src.trim()}${quote}`
      ).replace(
        /(<img\b.*?srcset=)(['"])(.*?)\2/gs,
        (_, prefix, quote, srcset) => `${prefix}${quote}${srcset.split(",").map(
          (item) => item.trim().replace(
            /^([^ ]*?)([ \n].*)?$/,
            (__, url, descriptor = "") => `${imgPath + url.trim()}${descriptor.replace(/[ \n]+/g, " ").trimEnd()}`
          )
        ).join(", ")}${quote}`
      );
      return rawHtmlRule(tokens, idx, options, env, self);
    };
    const rawHtmlBlockRule = md2.renderer.rules.html_block;
    const rawHtmlInlineRule = md2.renderer.rules.html_inline;
    md2.renderer.rules.html_block = createHtmlRule(rawHtmlBlockRule);
    md2.renderer.rules.html_inline = createHtmlRule(rawHtmlInlineRule);
  });
};
var err_throw = (error) => {
  if (error) {
    console.error(error);
    throw error;
  }
};

// build.ts
var build_default = (srcMDFilePath = `./src/md/`, mdPagesPath = "pages/", absMDPagesPath = `./src/assets/${mdPagesPath}`, imgPath = "/", absImgPath = `./public${imgPath}`) => {
  const blogPages = [];
  const md2 = createMD(imgPath);
  rmdir(absMDPagesPath);
  rmdir(absImgPath);
  fs2.readdirSync(srcMDFilePath).forEach((file) => {
    const filePath = srcMDFilePath + file;
    if (!file.endsWith(".md")) {
      fs2.cpSync(filePath, absImgPath + file, { recursive: true });
      return;
    }
    const mdContent = fs2.readFileSync(filePath, "utf8");
    const { data, content } = grayMatter(mdContent, { excerpt: false });
    data.date = formateDate(data.date);
    const htmlContent = md2.render(content);
    fs2.writeFile(absMDPagesPath + file.replace(".md", ".html"), htmlContent, err_throw);
    blogPages.push({
      profile: data,
      htmlContent,
      path: `/${mdPagesPath}${file.replace(".md", ".html")}`,
      name: file.replace(".md", "")
    });
  });
  fs2.writeFileSync(`${absMDPagesPath}blogPages.json`, JSON.stringify(blogPages));
};

// vite.config.ts
var __vite_injected_original_import_meta_url = "file:///root/p/pphome/nodejs/SongMingHe/vite.config.ts";
build_default();
var vite_config_default = defineConfig({
  plugins: [
    vue(),
    vueJsx()
  ],
  resolve: {
    alias: {
      "@": fileURLToPath(new URL("./src", __vite_injected_original_import_meta_url))
    }
  },
  server: {
    // 监听地址 0.0.0.0
    host: true
  }
});
export {
  vite_config_default as default
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsidml0ZS5jb25maWcudHMiLCAiYnVpbGQudHMiLCAiYnVpbGRVdGlscy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiY29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2Rpcm5hbWUgPSBcIi9yb290L3AvcHBob21lL25vZGVqcy9Tb25nTWluZ0hlXCI7Y29uc3QgX192aXRlX2luamVjdGVkX29yaWdpbmFsX2ZpbGVuYW1lID0gXCIvcm9vdC9wL3BwaG9tZS9ub2RlanMvU29uZ01pbmdIZS92aXRlLmNvbmZpZy50c1wiO2NvbnN0IF9fdml0ZV9pbmplY3RlZF9vcmlnaW5hbF9pbXBvcnRfbWV0YV91cmwgPSBcImZpbGU6Ly8vcm9vdC9wL3BwaG9tZS9ub2RlanMvU29uZ01pbmdIZS92aXRlLmNvbmZpZy50c1wiO2ltcG9ydCB7IGZpbGVVUkxUb1BhdGgsIFVSTCB9IGZyb20gJ25vZGU6dXJsJ1xuXG5pbXBvcnQgeyBkZWZpbmVDb25maWcgfSBmcm9tICd2aXRlJ1xuaW1wb3J0IHZ1ZSBmcm9tICdAdml0ZWpzL3BsdWdpbi12dWUnXG5pbXBvcnQgdnVlSnN4IGZyb20gJ0B2aXRlanMvcGx1Z2luLXZ1ZS1qc3gnXG5cbmltcG9ydCBidWlsZCBmcm9tICcuL2J1aWxkJ1xuXG5idWlsZCgpXG5cbi8vIGh0dHBzOi8vdml0ZWpzLmRldi9jb25maWcvXG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb25maWcoe1xuICBwbHVnaW5zOiBbXG4gICAgdnVlKCksXG4gICAgdnVlSnN4KCksXG4gIF0sXG4gIHJlc29sdmU6IHtcbiAgICBhbGlhczoge1xuICAgICAgJ0AnOiBmaWxlVVJMVG9QYXRoKG5ldyBVUkwoJy4vc3JjJywgaW1wb3J0Lm1ldGEudXJsKSlcbiAgICB9XG4gIH0sXG4gIHNlcnZlcjoge1xuICAgIC8vIFx1NzZEMVx1NTQyQ1x1NTczMFx1NTc0MCAwLjAuMC4wXG4gICAgaG9zdDogdHJ1ZVxuICB9XG59KVxuIiwgImNvbnN0IF9fdml0ZV9pbmplY3RlZF9vcmlnaW5hbF9kaXJuYW1lID0gXCIvcm9vdC9wL3BwaG9tZS9ub2RlanMvU29uZ01pbmdIZVwiO2NvbnN0IF9fdml0ZV9pbmplY3RlZF9vcmlnaW5hbF9maWxlbmFtZSA9IFwiL3Jvb3QvcC9wcGhvbWUvbm9kZWpzL1NvbmdNaW5nSGUvYnVpbGQudHNcIjtjb25zdCBfX3ZpdGVfaW5qZWN0ZWRfb3JpZ2luYWxfaW1wb3J0X21ldGFfdXJsID0gXCJmaWxlOi8vL3Jvb3QvcC9wcGhvbWUvbm9kZWpzL1NvbmdNaW5nSGUvYnVpbGQudHNcIjsvLyBodHRwczovL25vZGVqcy5vcmcvZG9jcy9sYXRlc3QvYXBpL2ZzLmh0bWxcbmltcG9ydCAqIGFzIGZzIGZyb20gJ2ZzJ1xuaW1wb3J0IGdyYXlNYXR0ZXIgZnJvbSAnZ3JheS1tYXR0ZXInXG5pbXBvcnQgeyBjcmVhdGVNRCwgcm1kaXIsIGZvcm1hdGVEYXRlLCBlcnJfdGhyb3cgfSBmcm9tICcuL2J1aWxkVXRpbHMnXG5cbmV4cG9ydCBkZWZhdWx0IChcbiAgc3JjTURGaWxlUGF0aCA9IGAuL3NyYy9tZC9gLFxuICBtZFBhZ2VzUGF0aCA9ICdwYWdlcy8nLFxuICBhYnNNRFBhZ2VzUGF0aCA9IGAuL3NyYy9hc3NldHMvJHttZFBhZ2VzUGF0aH1gLFxuICAvLyBpbWdQYXRoID0gJy9wYWdlc19pbWcvJyxcbiAgaW1nUGF0aCA9ICcvJyxcbiAgYWJzSW1nUGF0aCA9IGAuL3B1YmxpYyR7aW1nUGF0aH1gXG4pID0+IHtcbiAgY29uc3QgYmxvZ1BhZ2VzID0gW11cblxuICAvLyAgXHU1MjFCXHU1RUZBbWRcdTg5RTNcdTY3OTBcdTU2NjhcbiAgY29uc3QgbWQgPSBjcmVhdGVNRChpbWdQYXRoKVxuICAvLyAgXHU2RTA1XHU3NDA2XHU4RjkzXHU1MUZBXHU3NkVFXHU1RjU1XG4gIHJtZGlyKGFic01EUGFnZXNQYXRoKVxuICBybWRpcihhYnNJbWdQYXRoKVxuXG4gIC8vICBcdThCRkJcdTUzRDZtZFx1NjU4N1x1NEVGNlx1NTkzOVx1RkYwQ1x1NTkwNFx1NzQwNm1kXHU2NTg3XHU0RUY2XG4gIGZzLnJlYWRkaXJTeW5jKHNyY01ERmlsZVBhdGgpLmZvckVhY2goKGZpbGUpID0+IHtcbiAgICBjb25zdCBmaWxlUGF0aCA9IHNyY01ERmlsZVBhdGggKyBmaWxlXG4gICAgaWYgKCFmaWxlLmVuZHNXaXRoKCcubWQnKSkge1xuICAgICAgZnMuY3BTeW5jKGZpbGVQYXRoLCBhYnNJbWdQYXRoICsgZmlsZSwgeyByZWN1cnNpdmU6IHRydWUgfSlcbiAgICAgIHJldHVyblxuICAgIH1cbiAgICAvLyBcdThCRkJcdTUzRDZtZFx1NjU4N1x1NEVGNlx1NTE4NVx1NUJCOVxuICAgIGNvbnN0IG1kQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhmaWxlUGF0aCwgJ3V0ZjgnKVxuICAgIGNvbnN0IHsgZGF0YSwgY29udGVudCB9ID0gZ3JheU1hdHRlcihtZENvbnRlbnQsIHsgZXhjZXJwdDogZmFsc2UgfSlcbiAgICBkYXRhLmRhdGUgPSBmb3JtYXRlRGF0ZShkYXRhLmRhdGUpXG5cbiAgICBjb25zdCBodG1sQ29udGVudCA9IG1kLnJlbmRlcihjb250ZW50KVxuICAgIGZzLndyaXRlRmlsZShhYnNNRFBhZ2VzUGF0aCArIGZpbGUucmVwbGFjZSgnLm1kJywgJy5odG1sJyksIGh0bWxDb250ZW50LCBlcnJfdGhyb3cpXG4gICAgYmxvZ1BhZ2VzLnB1c2goe1xuICAgICAgcHJvZmlsZTogZGF0YSxcbiAgICAgIGh0bWxDb250ZW50LFxuICAgICAgcGF0aDogYC8ke21kUGFnZXNQYXRofSR7ZmlsZS5yZXBsYWNlKCcubWQnLCAnLmh0bWwnKX1gLFxuICAgICAgbmFtZTogZmlsZS5yZXBsYWNlKCcubWQnLCAnJylcbiAgICB9KVxuICB9KVxuICBmcy53cml0ZUZpbGVTeW5jKGAke2Fic01EUGFnZXNQYXRofWJsb2dQYWdlcy5qc29uYCwgSlNPTi5zdHJpbmdpZnkoYmxvZ1BhZ2VzKSlcbn1cbiIsICJjb25zdCBfX3ZpdGVfaW5qZWN0ZWRfb3JpZ2luYWxfZGlybmFtZSA9IFwiL3Jvb3QvcC9wcGhvbWUvbm9kZWpzL1NvbmdNaW5nSGVcIjtjb25zdCBfX3ZpdGVfaW5qZWN0ZWRfb3JpZ2luYWxfZmlsZW5hbWUgPSBcIi9yb290L3AvcHBob21lL25vZGVqcy9Tb25nTWluZ0hlL2J1aWxkVXRpbHMudHNcIjtjb25zdCBfX3ZpdGVfaW5qZWN0ZWRfb3JpZ2luYWxfaW1wb3J0X21ldGFfdXJsID0gXCJmaWxlOi8vL3Jvb3QvcC9wcGhvbWUvbm9kZWpzL1NvbmdNaW5nSGUvYnVpbGRVdGlscy50c1wiO2ltcG9ydCBNYXJrZG93bkl0IGZyb20gJ21hcmtkb3duLWl0J1xuaW1wb3J0ICogYXMgZnMgZnJvbSAnZnMnXG5cbmNvbnN0IGZvcm1hdGVEYXRlID0gKHNyY0RhdGU6IERhdGUgfCBzdHJpbmcpOiBzdHJpbmcgPT4ge1xuICBsZXQgc3JjRGF0ZU9iaiA9IHNyY0RhdGVcbiAgaWYgKHR5cGVvZiBzcmNEYXRlID09PSAnc3RyaW5nJykge1xuICAgIHNyY0RhdGVPYmogPSBuZXcgRGF0ZShEYXRlLnBhcnNlKHNyY0RhdGUpKVxuICB9XG4gIC8vIGxldCBob3VycyA9IFN0cmluZyhzcmNEYXRlT2JqLmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsICcwJylcbiAgLy8gbGV0IG1pbnV0ZXMgPSBTdHJpbmcoc3JjRGF0ZU9iai5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsICcwJylcbiAgLy8gbGV0IHNlY29uZHMgPSBTdHJpbmcoc3JjRGF0ZU9iai5nZXRTZWNvbmRzKCkpLnBhZFN0YXJ0KDIsICcwJylcblxuICByZXR1cm4gYCR7c3JjRGF0ZU9iai5nZXRGdWxsWWVhcigpfS0ke1N0cmluZyhzcmNEYXRlT2JqLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpfS0ke1N0cmluZyhzcmNEYXRlT2JqLmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKX1gXG59XG5cbi8vICBcdTZFMDVcdTc0MDZcdTc2RUVcdTVGNTVcbmNvbnN0IHJtZGlyID0gKHJtZGlyUGF0aCkgPT4ge1xuICB0cnkge1xuICAgIGZzLnJtU3luYyhybWRpclBhdGgsIHsgcmVjdXJzaXZlOiB0cnVlIH0pXG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChlcnIgJiYgZXJyLmNvZGUgIT09ICdFTk9FTlQnKSB7XG4gICAgICB0aHJvdyBlcnJcbiAgICB9XG4gIH1cbiAgLy8gIFx1OTFDRFx1NjVCMFx1NTIxQlx1NUVGQVx1NzZFRVx1NUY1NVxuICBmcy5ta2RpclN5bmMocm1kaXJQYXRoKVxufVxuY29uc3QgY3JlYXRlTUQgPSAoaW1nUGF0aDogc3RyaW5nKTogTWFya2Rvd25JdCA9PiB7XG4gIHJldHVybiBNYXJrZG93bkl0KHtcbiAgICBodG1sOiB0cnVlLCAvLyBcdTU3MjhcdTZFOTBcdTc4MDFcdTRFMkRcdTU0MkZcdTc1MjggSFRNTCBcdTY4MDdcdTdCN0VcbiAgICB4aHRtbE91dDogZmFsc2UsIC8vIFx1NEY3Rlx1NzUyOCAnLycgXHU2NzY1XHU5NUVEXHU1NDA4XHU1MzU1XHU2ODA3XHU3QjdFIFx1RkYwOFx1NkJENFx1NTk4MiA8YnIgLz5cdUZGMDlcdTMwMDJcbiAgICAvLyBcdThGRDlcdTRFMkFcdTkwMDlcdTk4NzlcdTUzRUFcdTVCRjlcdTVCOENcdTUxNjhcdTc2ODQgQ29tbW9uTWFyayBcdTZBMjFcdTVGMEZcdTUxN0NcdTVCQjlcdTMwMDJcbiAgICBicmVha3M6IGZhbHNlLCAvLyBcdThGNkNcdTYzNjJcdTZCQjVcdTg0M0RcdTkxQ0NcdTc2ODQgJ1xcbicgXHU1MjMwIDxicj5cdTMwMDJcbiAgICBsYW5nUHJlZml4OiAnbGFuZ3VhZ2UtJywgLy8gXHU3RUQ5XHU1NkY0XHU2ODBGXHU0RUUzXHU3ODAxXHU1NzU3XHU3Njg0IENTUyBcdThCRURcdThBMDBcdTUyNERcdTdGMDBcdTMwMDJcdTVCRjlcdTRFOEVcdTk4OURcdTU5MTZcdTc2ODRcdTlBRDhcdTRFQUVcdTRFRTNcdTc4MDFcdTk3NUVcdTVFMzhcdTY3MDlcdTc1MjhcdTMwMDJcbiAgICBsaW5raWZ5OiBmYWxzZSwgLy8gXHU1QzA2XHU3QzdCXHU0RjNDIFVSTCBcdTc2ODRcdTY1ODdcdTY3MkNcdTgxRUFcdTUyQThcdThGNkNcdTYzNjJcdTRFM0FcdTk0RkVcdTYzQTVcdTMwMDJcblxuICAgIC8vIFx1NTQyRlx1NzUyOFx1NEUwMFx1NEU5Qlx1OEJFRFx1OEEwMFx1NEUyRFx1N0FDQlx1NzY4NFx1NjZGRlx1NjM2MiArIFx1NUYxNVx1NTNGN1x1N0Y4RVx1NTMxNlxuICAgIHR5cG9ncmFwaGVyOiBmYWxzZSxcblxuICAgIC8vIFx1NTNDQyArIFx1NTM1NVx1NUYxNVx1NTNGN1x1NjZGRlx1NjM2Mlx1NUJGOVx1RkYwQ1x1NUY1MyB0eXBvZ3JhcGhlciBcdTU0MkZcdTc1MjhcdTY1RjZcdTMwMDJcbiAgICAvLyBcdTYyMTZcdTgwMDVcdTY2N0FcdTgwRkRcdTVGMTVcdTUzRjdcdTdCNDlcdUZGMENcdTUzRUZcdTRFRTVcdTY2MkYgU3RyaW5nIFx1NjIxNiBBcnJheVx1MzAwMlxuICAgIC8vXG4gICAgLy8gXHU2QkQ0XHU2NUI5XHU4QkY0XHVGRjBDXHU0RjYwXHU1M0VGXHU0RUU1XHU2NTJGXHU2MzAxICdcdTAwQUJcdTAwQkJcdTIwMUVcdTIwMUMnIFx1N0VEOVx1NEZDNFx1N0Y1N1x1NjVBRlx1NEVCQVx1NEY3Rlx1NzUyOFx1RkYwQyAnXHUyMDFFXHUyMDFDXHUyMDFBXHUyMDE4JyAgXHU3RUQ5XHU1RkI3XHU1NkZEXHU0RUJBXHU0RjdGXHU3NTI4XHUzMDAyXG4gICAgLy8gXHU4RkQ4XHU2NzA5IFsnXHUwMEFCXFx4QTAnLCAnXFx4QTBcdTAwQkInLCAnXHUyMDM5XFx4QTAnLCAnXFx4QTBcdTIwM0EnXSBcdTdFRDlcdTZDRDVcdTU2RkRcdTRFQkFcdTRGN0ZcdTc1MjhcdUZGMDhcdTUzMDVcdTYyRUMgbmJzcFx1RkYwOVx1MzAwMlxuICAgIHF1b3RlczogJ1x1MjAxQ1x1MjAxRFx1MjAxOFx1MjAxOScsXG5cbiAgICAvLyBcdTlBRDhcdTRFQUVcdTUxRkRcdTY1NzBcdUZGMENcdTRGMUFcdThGRDRcdTU2REVcdThGNkNcdTRFNDlcdTc2ODRIVE1MXHUzMDAyXG4gICAgLy8gXHU2MjE2ICcnIFx1NTk4Mlx1Njc5Q1x1NkU5MFx1NUI1N1x1N0IyNlx1NEUzMlx1NjcyQVx1NjZGNFx1NjUzOVx1RkYwQ1x1NTIxOVx1NUU5NFx1NTcyOFx1NTkxNlx1OTBFOFx1OEZEQlx1ODg0Q1x1OEY2Q1x1NEU0OVx1MzAwMlxuICAgIC8vIFx1NTk4Mlx1Njc5Q1x1N0VEM1x1Njc5Q1x1NEVFNSA8cHJlIC4uLiBcdTVGMDBcdTU5MzRcdUZGMENcdTUxODVcdTkwRThcdTUzMDVcdTg4QzVcdTU2NjhcdTUyMTlcdTRGMUFcdThERjNcdThGQzdcdTMwMDJcbiAgICBoaWdobGlnaHQ6IGZ1bmN0aW9uICgvKnN0ciwgbGFuZyovKSB7XG4gICAgICByZXR1cm4gJydcbiAgICB9XG4gIH0pXG4gIC8vIFx1NTZGRVx1NzI0N1x1OERFRlx1NUY4NFx1NTkwNFx1NzQwNlx1NjNEMlx1NEVGNlxuICBtZC51c2UoKG1kKSA9PiB7XG4gICAgLy8gd3JhcCByYXcgaW1hZ2UgcmVuZGVyZXIgcnVsZVxuICAgIGNvbnN0IHJhd0ltYWdlUnVsZSA9IG1kLnJlbmRlcmVyLnJ1bGVzLmltYWdlIVxuICAgIG1kLnJlbmRlcmVyLnJ1bGVzLmltYWdlID0gKHRva2VucywgaWR4LCBvcHRpb25zLCBlbnY6IE1hcmtkb3duRW52LCBzZWxmKSA9PiB7XG4gICAgICBjb25zdCB0b2tlbiA9IHRva2Vuc1tpZHhdXG5cbiAgICAgIC8vIGdldCB0aGUgaW1hZ2UgbGlua1xuICAgICAgY29uc3QgbGluayA9IHRva2VuLmF0dHJHZXQoJ3NyYycpXG5cbiAgICAgIGlmIChsaW5rKSB7XG4gICAgICAgIC8vIHJlcGxhY2UgdGhlIG9yaWdpbmFsIGxpbmsgd2l0aCByZXNvbHZlZCBsaW5rXG4gICAgICAgIHRva2VuLmF0dHJTZXQoJ3NyYycsIGltZ1BhdGggKyBsaW5rKVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmF3SW1hZ2VSdWxlKHRva2VucywgaWR4LCBvcHRpb25zLCBlbnYsIHNlbGYpXG4gICAgfVxuXG4gICAgLy8gd3JhcCByYXcgaHRtbCByZW5kZXJlciBydWxlXG4gICAgY29uc3QgY3JlYXRlSHRtbFJ1bGUgPVxuICAgICAgKHJhd0h0bWxSdWxlOiBSZW5kZXJSdWxlKTogUmVuZGVyUnVsZSA9PlxuICAgICAgKHRva2VucywgaWR4LCBvcHRpb25zLCBlbnY6IE1hcmtkb3duRW52LCBzZWxmKSA9PiB7XG4gICAgICAgIC8vIHJlcGxhY2UgdGhlIG9yaWdpbmFsIGxpbmsgd2l0aCByZXNvbHZlZCBsaW5rXG4gICAgICAgIHRva2Vuc1tpZHhdLmNvbnRlbnQgPSB0b2tlbnNbaWR4XS5jb250ZW50XG4gICAgICAgICAgLy8gaGFuZGxlIHNyY1xuICAgICAgICAgIC5yZXBsYWNlKFxuICAgICAgICAgICAgLyg8aW1nXFxiLio/c3JjPSkoWydcIl0pKC4qPylcXDIvZ3MsXG4gICAgICAgICAgICAoXywgcHJlZml4OiBzdHJpbmcsIHF1b3RlOiBzdHJpbmcsIHNyYzogc3RyaW5nKSA9PlxuICAgICAgICAgICAgICBgJHtwcmVmaXh9JHtxdW90ZX0ke2ltZ1BhdGggKyBzcmMudHJpbSgpfSR7cXVvdGV9YFxuICAgICAgICAgIClcbiAgICAgICAgICAvLyBoYW5kbGUgc3Jjc2V0XG4gICAgICAgICAgLnJlcGxhY2UoXG4gICAgICAgICAgICAvKDxpbWdcXGIuKj9zcmNzZXQ9KShbJ1wiXSkoLio/KVxcMi9ncyxcbiAgICAgICAgICAgIChfLCBwcmVmaXg6IHN0cmluZywgcXVvdGU6IHN0cmluZywgc3Jjc2V0OiBzdHJpbmcpID0+XG4gICAgICAgICAgICAgIGAke3ByZWZpeH0ke3F1b3RlfSR7c3Jjc2V0XG4gICAgICAgICAgICAgICAgLnNwbGl0KCcsJylcbiAgICAgICAgICAgICAgICAubWFwKChpdGVtKSA9PlxuICAgICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAudHJpbSgpXG4gICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKFxuICAgICAgICAgICAgICAgICAgICAgIC9eKFteIF0qPykoWyBcXG5dLiopPyQvLFxuICAgICAgICAgICAgICAgICAgICAgIChfXywgdXJsOiBzdHJpbmcsIGRlc2NyaXB0b3I6IHN0cmluZyB8IHVuZGVmaW5lZCA9ICcnKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgYCR7aW1nUGF0aCArIHVybC50cmltKCl9JHtkZXNjcmlwdG9yLnJlcGxhY2UoL1sgXFxuXSsvZywgJyAnKS50cmltRW5kKCl9YFxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIC5qb2luKCcsICcpfSR7cXVvdGV9YFxuICAgICAgICAgIClcblxuICAgICAgICByZXR1cm4gcmF3SHRtbFJ1bGUodG9rZW5zLCBpZHgsIG9wdGlvbnMsIGVudiwgc2VsZilcbiAgICAgIH1cbiAgICBjb25zdCByYXdIdG1sQmxvY2tSdWxlID0gbWQucmVuZGVyZXIucnVsZXMuaHRtbF9ibG9jayFcbiAgICBjb25zdCByYXdIdG1sSW5saW5lUnVsZSA9IG1kLnJlbmRlcmVyLnJ1bGVzLmh0bWxfaW5saW5lIVxuICAgIG1kLnJlbmRlcmVyLnJ1bGVzLmh0bWxfYmxvY2sgPSBjcmVhdGVIdG1sUnVsZShyYXdIdG1sQmxvY2tSdWxlKVxuICAgIG1kLnJlbmRlcmVyLnJ1bGVzLmh0bWxfaW5saW5lID0gY3JlYXRlSHRtbFJ1bGUocmF3SHRtbElubGluZVJ1bGUpXG4gIH0pXG59XG5cbi8vIFx1NUYwMlx1NUUzOFx1NTkwNFx1NzQwNlx1NTZERVx1OEMwM1x1NTFGRFx1NjU3MFxuY29uc3QgZXJyX3Rocm93ID0gKGVycm9yKSA9PiB7XG4gIGlmIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgdGhyb3cgZXJyb3JcbiAgfVxufVxuXG5leHBvcnQgeyBjcmVhdGVNRCwgcm1kaXIsIGZvcm1hdGVEYXRlLCBlcnJfdGhyb3cgfVxuIl0sCiAgIm1hcHBpbmdzIjogIjtBQUFrUixTQUFTLGVBQWUsV0FB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UyxNQUFNLGFBQWEsZUFBZSxnQkFBZ0I7QUFDOUQsSUFBQUEsSUFBRyxTQUFTLE1BQU0sY0FBYyxlQUFlLGlCQUFpQjtBQUFBLEVBQ2xFLENBQUM7QUFDSDtBQUdBLElBQU0sWUFBWSxDQUFDLFVBQVU7QUFDM0IsTUFBSSxPQUFPO0FBQ1QsWUFBUSxNQUFNLEtBQUs7QUFDbkIsVUFBTTtBQUFBLEVBQ1I7QUFDRjs7O0FEL0dBLElBQU8sZ0JBQVEsQ0FDYixnQkFBZ0IsYUFDaEIsY0FBYyxVQUNkLGlCQUFpQixnQkFBZ0IsV0FBVyxJQUU1QyxVQUFVLEtBQ1YsYUFBYSxXQUFXLE9BQU8sT0FDNUI7QUFDSCxRQUFNLFlBQVksQ0FBQztBQUduQixRQUFNQyxNQUFLLFNBQVMsT0FBTztBQUUzQixRQUFNLGNBQWM7QUFDcEIsUUFBTSxVQUFVO0FBR2hCLEVBQUcsZ0JBQVksYUFBYSxFQUFFLFFBQVEsQ0FBQyxTQUFTO0FBQzlDLFVBQU0sV0FBVyxnQkFBZ0I7QUFDakMsUUFBSSxDQUFDLEtBQUssU0FBUyxLQUFLLEdBQUc7QUFDekIsTUFBRyxXQUFPLFVBQVUsYUFBYSxNQUFNLEVBQUUsV0FBVyxLQUFLLENBQUM7QUFDMUQ7QUFBQSxJQUNGO0FBRUEsVUFBTSxZQUFlLGlCQUFhLFVBQVUsTUFBTTtBQUNsRCxVQUFNLEVBQUUsTUFBTSxRQUFRLElBQUksV0FBVyxXQUFXLEVBQUUsU0FBUyxNQUFNLENBQUM7QUFDbEUsU0FBSyxPQUFPLFlBQVksS0FBSyxJQUFJO0FBRWpDLFVBQU0sY0FBY0EsSUFBRyxPQUFPLE9BQU87QUFDckMsSUFBRyxjQUFVLGlCQUFpQixLQUFLLFFBQVEsT0FBTyxPQUFPLEdBQUcsYUFBYSxTQUFTO0FBQ2xGLGNBQVUsS0FBSztBQUFBLE1BQ2IsU0FBUztBQUFBLE1BQ1Q7QUFBQSxNQUNBLE1BQU0sSUFBSSxXQUFXLEdBQUcsS0FBSyxRQUFRLE9BQU8sT0FBTyxDQUFDO0FBQUEsTUFDcEQsTUFBTSxLQUFLLFFBQVEsT0FBTyxFQUFFO0FBQUEsSUFDOUIsQ0FBQztBQUFBLEVBQ0gsQ0FBQztBQUNELEVBQUcsa0JBQWMsR0FBRyxjQUFjLGtCQUFrQixLQUFLLFVBQVUsU0FBUyxDQUFDO0FBQy9FOzs7QUQzQ3dLLElBQU0sMkNBQTJDO0FBUXpOLGNBQU07QUFHTixJQUFPLHNCQUFRLGFBQWE7QUFBQSxFQUMxQixTQUFTO0FBQUEsSUFDUCxJQUFJO0FBQUEsSUFDSixPQUFPO0FBQUEsRUFDVDtBQUFBLEVBQ0EsU0FBUztBQUFBLElBQ1AsT0FBTztBQUFBLE1BQ0wsS0FBSyxjQUFjLElBQUksSUFBSSxTQUFTLHdDQUFlLENBQUM7QUFBQSxJQUN0RDtBQUFBLEVBQ0Y7QUFBQSxFQUNBLFFBQVE7QUFBQTtBQUFBLElBRU4sTUFBTTtBQUFBLEVBQ1I7QUFDRixDQUFDOyIsCiAgIm5hbWVzIjogWyJmcyIsICJtZCIsICJtZCJdCn0K
